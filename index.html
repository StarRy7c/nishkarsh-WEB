<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live TV Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .channel-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1.5rem;
        }
        @media (min-width: 640px) {
            .channel-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }
        }
        .channel-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .channel-card:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px rgba(0, 122, 255, 0.5);
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">

    <div id="app-container">
        <!-- This container will be filled by JavaScript -->
    </div>

    <!-- Main Application Logic -->
    <script>
        const channels = [
            {"id": "sony12", "name": "Sony Sports 12", "mpd": "https://live2.shoq.com.pk/live/eds/ICC_Women_World_Cup_2025/DASH/ICC_Women_World_Cup_2025.mpd", "key": "a6dfc4f17d70d8d07639659193f03b25:893eacfabe386144b81733d622a7ad17"},
            {"id": "amzonhindi", "name": "Amazon Prime Hindi", "mpd": "https://ottb.live.cf.ww.aiv-cdn.net/sin-nitro/live/dash/enc/jr0zvtazlv/out/v1/6bae9634f7594a738530656284177423/cenc.mpd", "key": "2ce2e7d0af813fd26c6fe0b59201ced5:1416f69da90f62735a6521aae461dd74"},
            {"id": "amzoneng", "name": "Amazon Prime English", "mpd": "https://ottb.live.cf.ww.aiv-cdn.net/sin-nitro/live/dash/enc/hxmndltwen/out/v1/d346b8e088254045bf5ecde7cf5d335a/cenc.mpd", "key": "e51d0a028b213b7df472b5f39dc15a8f:bc00a08336fa155814a2e7f47cd42a03"},
            {"id": "shoq", "name": "Shoq TV", "mpd": "https://live2.shoq.com.pk/live/eds/ICC_Women_World_Cup_2025/DASH/ICC_Women_World_Cup_2025.mpd", "key": "a6dfc4f17d70d8d07639659193f03b25:893eacfabe386144b81733d622a7ad17"},
            {"id": "sony1", "name": "Sony Sports Ten 1", "m3u8": "https://cors-anywhere.creativeclaritycreations.com/http://195.181.169.162:80/TEN_1_HD/index.m3u8?token=test"},
            {"id": "sony11", "name": "Sony Sports Ten 1.1", "m3u8": "https://cors-anywhere.creativeclaritycreations.com/http://51.15.7.9:3141/ten1/index.m3u8"},
            {"id": "sony13", "name": "Sony Sports Ten 1.3", "m3u8": "https://tvgo.neocities.org/APPTV/sony?id=SONY%20SPORTS%20TEN%201%20HD"},
            {"id": "sony14", "name": "Sony Sports Ten 1.4", "m3u8": "https://tvgo.neocities.org/APPTV/toffee?id=sony_sports_1_hd"},
            {"id": "sony2", "name": "Sony Sports Ten 2", "m3u8": "https://cors-anywhere.creativeclaritycreations.com/http://195.181.169.162:80/TEN_2_HD/index.m3u8?token=test"},
            {"id": "sony21", "name": "Sony Sports Ten 2.1", "m3u8": "https://cors-anywhere.creativeclaritycreations.com/http://51.15.7.9:3141/ten2/index.m3u8"},
            {"id": "sony22", "name": "Sony Sports Ten 2.2", "m3u8": "https://tvgo.neocities.org/APPTV/sony?id=SONY%20SPORTS%20TEN%202%20HD"},
            {"id": "sony3", "name": "Sony Sports Ten 3", "m3u8": "https://cors-anywhere.creativeclaritycreations.com/http://195.181.169.162:80/TEN_3_HD/index.m3u8?token=test"},
            {"id": "sony31", "name": "Sony Sports Ten 3.1", "m3u8": "https://cors-anywhere.creativeclaritycreations.com/http://51.15.7.9:3141/ten3/index.m3u8"},
            {"id": "sony32", "name": "Sony Sports Ten 3.2", "m3u8": "https://tvgo.neocities.org/APPTV/sony?id=SONY%20SPORTS%20TEN%203%20HD"},
            {"id": "sony34", "name": "Sony Sports Ten 3.4", "m3u8": "https://tvgo.neocities.org/APPTV/sony?id=SONY%20SPORTS%20TEN%203"},
            {"id": "sony4", "name": "Sony Sports Ten 4", "m3u8": "https://cors-anywhere.creativeclaritycreations.com/http://195.181.169.162:80/TEN_4_HD/index.m3u8?token=test"},
            {"id": "sony41", "name": "Sony Sports Ten 4.1", "m3u8": "https://tvgo.neocities.org/APPTV/sony?id=SONY%20SPORTS%20TEN%204"},
            {"id": "sony5", "name": "Sony Sports Ten 5", "m3u8": "https://cors-anywhere.creativeclaritycreations.com/http://195.181.169.162:80/TEN_5_HD/index.m3u8?token=test"},
            {"id": "sony51", "name": "Sony Sports Ten 5.1", "m3u8": "https://cors-anywhere.creativeclaritycreations.com/http://51.15.7.9:3141/ten5/index.m3u8"},
            {"id": "criclifemax", "name": "CricLife Max", "mpd": "https://cors-anywhere.creativeclaritycreations.com/https://ev-fast-mpd.starzplayarabia.com/live/eds/CricLifeMax/DASH/CricLifeMax.mpd", "key": "ad59b720bd4b44d063686212b99484b5:e1744990edf98acc729c0773a3766583"},
            {"id": "criclife", "name": "CricLife", "mpd": "https://cors-anywhere.creativeclaritycreations.com/https://ev-fast-mpd.starzplayarabia.com/live/eds/CricLife1/DASH/CricLife1.mpd", "key": "1e23e51b09a67b83813c17049870bcd4:c3d6288e378b0dc55320fd0e6fd2e55f"},
            {"id": "cricbuzz1", "name": "Cricbuzz 1", "mpd": "https://cors-anywhere.creativeclaritycreations.com/https://ev-fast-mpd.starzplayarabia.com/live/eds/CricLife2/DASH/CricLife2.mpd", "key": "48bef83b4c6a3c5189b01b0126210da4:bd085230b7b09e50954fe0af111a8a9f"},
            {"id": "cricbuzz2", "name": "Cricbuzz 2", "mpd": "https://cors-anywhere.creativeclaritycreations.com/https://ev-fast-mpd.starzplayarabia.com/live/eds/Criclife_3/DASH/Criclife_3.mpd", "key": "4e8b5ddac5332a4e66c002b4c0f22322:d06de29b0eacb81ac6e3f325849047e8"},
            {"id": "astrocricket", "name": "Astro Cricket", "m3u8": "https://tgn.bozztv.com/eshgtv-dvrfl05/gin-lemar/index.m3u8"},
            {"id": "astrocricket1", "name": "Astro Cricket 1", "mpd": "https://oriby-streaming-proxy.sultanarabi161.workers.dev/https://linearjitp-playback.astro.com.my/dash-wv/linear/2504/default_ott.mpd", "key": "03c2e0af2f8159f9f0ce9b5dbc865f10:cd84ed136b0cc71f8ab8cd4d4f6a2e4c"},
            {"id": "fox", "name": "Fox Cricket", "m3u8": "https://allinonereborn.fun/sansat-web/live1.php?id=83174"},
            {"id": "willowtv", "name": "Willow TV", "m3u8": "https://fl7.moveonjoy.com/WILLOW_CRICKET/index.m3u8"},
            {"id": "willowsports", "name": "Willow Sports", "mpd": "https://abmyxykaaaaaaaamkyvb65fuqebyg.7a77200bf98444ac997a89ed83775793.emt.cf.ww.aiv-cdn.net/iad-nitro/live/clients/dash/enc/f60kqesunw/out/v1/a435ed7a00f947deb4369b46d8f2fb70/cenc.mpd", "key": "1779c27b9d077a3ba0c9cc1bb9a94b9f:cc5cf3b7928fb9e0a1ee6a8b566f0a8e"},
            {"id": "skycricket", "name": "Sky Sports Cricket", "m3u8": "https://wasitv-pro.site/crichd/master.m3u8/?c=skyscric&key=WASITV"},
            {"id": "sts1h", "name": "Star Sports 1 Hindi", "m3u8": "https://jall.pages.dev/?url=https://jiotvpllive.cdn.jio.com/bpk-tv/Star_Sports_HD1_Hindi_BTS/output/index.mpd&keyId=400131994b445d8c8817202248760fda&key=2d56cb6f07a75b9aff165d534ae2bfc4"},
            {"id": "sts1", "name": "Star Sports 1", "m3u8": "https://tv4wap.neocities.org/live"},
            {"id": "tnt1", "name": "TNT Sports 1", "mpd": "https://ottb.live.cf.ww.aiv-cdn.net/lhr-nitro/live/dash/enc/bsaaetko8v/out/v1/bd3b0c314fff4bb1ab4693358f3cd2d3/cenc.mpd", "key": "5deb190b1dac28e46c0bdada7668b7de:ddd2b372702e42b0d2708a70b91dec8d"},
            {"id": "tnt2", "name": "TNT Sports 2", "mpd": "https://ottb.live.cf.ww.aiv-cdn.net/lhr-nitro/live/dash/enc/f0qvkrra8j/out/v1/f8fa17f087564f51aa4d5c700be43ec4/cenc.mpd", "key": "0d9efa8287a52a2497a281f7a9012211:e4f832d372943014fe5c30928a90e547"},
            {"id": "tencricket", "name": "Ten Cricket", "mpd": "https://edge3-moblive.yuppcdn.net/drm/smil:tencricketdrm.smil/manifest.mpd", "key": "9872e439f21f4a299cab249c6554daa3:0cdfcfe0d0f1fbe100554ce3ef4c4665"},
            {"id": "ptv", "name": "PTV Sports", "m3u8": "https://bdixiptvbd.com/live/play.php?cricid=ptvpk"},
            {"id": "asports", "name": "A Sports", "m3u8": "https://bdixiptvbd.com/live/play.php?cricid=asportshd"},
            {"id": "geosuper", "name": "Geo Super", "mpd": "https://live2.shoq.com.pk/live/eds/Geo_Super/DASH/Geo_Super.mpd", "key": "7641daa5bacfbb61936c40a221c9e78e:5732dd242f28338e909dc06cb1a1e5a2"},
            {"id": "euro1", "name": "Euro Sport 1", "mpd": "https://v4-pan-n79-cdn-01.live.cdn.cgates.lt/live/dash/561802/index.mpd", "key": "01a665d487aa4c1c898c9eb0ff1a21df:a0b9df5f92e6b218ddb6aa40a2cd996d"},
            {"id": "bein1", "name": "Bein Sports 1", "mpd": "https://aba5sdmaaaaaaaamooyrewxky2c4j.otte.live.cf.ww.aiv-cdn.net/syd-nitro/live/dash/enc/ghwcl6hv68/out/v1/83536910d8034e9b9895a20fbe1c1687/cenc.mpd", "key": "335dad778109954503dcbb21dc92015f:24bfd75d436cbf73168a2a2dccd40281"},
            {"id": "ssc1", "name": "SSC 1", "mpd": "https://ssc1-ak.akamaized.net/out/v1/c696e4819b55414388a1a487e8a45ca1/index.mpd", "key": "d84c325f36814f39bbe59080272b10c3:550727de4c96ef1ecff874905493580f"},
            {"id": "tsn1", "name": "TSN 1", "m3u8": "http://fl5.moveonjoy.com/TSN_1/index.m3u8"},
            {"id": "spotv", "name": "SPOTV", "mpd": "https://linearjitp-playback.astro.com.my/dash-wv/linear/5058/default_ott.mpd", "key": "c0e1804aa1d9fd9c41c41bf0f61a5f10:758823e4eabb6e4c8c036d073db46b8c"},
            // ... Add all other channels here following the same format
        ];

        function getMpdPlayerHtml(channel) {
            const [kid, key] = channel.key.split(':');
            return `
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <meta name="referrer" content="no-referrer">
                    <title>Player | ${channel.name}</title>
                    <link href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.11/controls.min.css" rel="stylesheet">
                    <style>
                        html, body { height: 100%; width: 100%; margin: 0; padding: 0; font-family: 'Inter', Arial, sans-serif; background: #000; color: white; overflow: hidden; }
                        .video-container { width: 100%; height: 100%; background: #000; }
                        #video { width: 100%; height: 100%; object-fit: contain; }
                    </style>
                </head>
                <body>
                    <div class="video-container" data-shaka-player-container shaka-controls="true">
                        <video autoplay data-shaka-player id="video" muted poster="https://placehold.co/1280x720/000000/FFFFFF?text=Loading+${encodeURIComponent(channel.name)}..." preload="auto"></video>
                    </div>
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.11/shaka-player.ui.min.js" crossorigin="anonymous"><\/script>
                    <script>
                        document.addEventListener('contextmenu', event => event.preventDefault());
                        async function init() {
                            const video = document.getElementById("video");
                            const ui = video.ui;
                            const controls = ui.getControls();
                            const player = controls.getPlayer();
                            player.configure({ drm: { clearKeys: { '${kid}': '${key}' } } });
                            try {
                                await player.load('${channel.mpd}');
                            } catch (e) { console.error("Shaka Player Error", e); }
                        }
                        document.addEventListener("shaka-ui-loaded", init);
                    <\/script>
                </body>
                </html>`;
        }

        function getM3u8PlayerHtml(channel) {
            return `
                <!DOCTYPE html>
                <html lang="en">
                <head>
                  <title>Player | ${channel.name}</title>
                  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
                  <meta name="referrer" content="no-referrer"/>
                  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/plyr@3.7.8/dist/plyr.css"/>
                  <style>
                    body { background-color: #000; margin: 0; padding: 0; overflow: hidden; }
                    html, body { height: 100%; }
                    .plyr { height: 100%; }
                  </style>
                </head>
                <body>
                  <video id="player" autoplay muted controls crossorigin playsinline poster="https://placehold.co/1280x720/000000/FFFFFF?text=Loading+${encodeURIComponent(channel.name)}..."></video>
                  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.7/dist/hls.min.js"><\/script>
                  <script src="https://cdn.jsdelivr.net/npm/plyr@3.7.8/dist/plyr.min.js"><\/script>
                  <script>
                    document.addEventListener('contextmenu', event => event.preventDefault());
                    document.addEventListener('DOMContentLoaded', () => {
                      const video = document.getElementById('player');
                      const source = '${channel.m3u8}';
                      if (Hls.isSupported()) {
                        const hls = new Hls();
                        hls.loadSource(source);
                        hls.attachMedia(video);
                        hls.on(Hls.Events.MANIFEST_PARSED, () => {
                          new Plyr(video, { controls: ['play-large', 'play', 'mute', 'volume', 'settings', 'fullscreen'] });
                        });
                      } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                        video.src = source;
                        new Plyr(video);
                      }
                    });
                  <\/script>
                </body>
                </html>`;
        }
        
        function renderChannelGrid(filteredChannels = channels) {
            const appContainer = document.getElementById('app-container');
            let channelCardsHtml = '';

            filteredChannels.forEach(channel => {
                const logoText = encodeURIComponent(channel.name);
                const logoUrl = `https://placehold.co/400x240/1a202c/718096?text=${logoText}&font=inter`;
                channelCardsHtml += `
                    <div class="channel-card cursor-pointer bg-gray-800 rounded-lg overflow-hidden flex flex-col items-center p-3 border-2 border-gray-700 hover:border-blue-500" data-channel-id="${channel.id}">
                        <img src="${logoUrl}" alt="${channel.name} Logo" class="w-full h-auto object-cover rounded-md mb-2">
                        <p class="text-sm font-semibold text-center text-gray-300">${channel.name}</p>
                    </div>
                `;
            });

            appContainer.innerHTML = `
                <div class="container mx-auto p-4 sm:p-6 lg:p-8">
                    <header class="text-center mb-8">
                        <h1 class="text-4xl sm:text-5xl font-bold tracking-tight">Live TV Hub</h1>
                        <p class="text-gray-400 mt-2">Select a channel to start watching</p>
                        <div class="mt-6 max-w-lg mx-auto">
                           <input type="text" id="search-box" placeholder="Search channels..." class="w-full px-4 py-2 bg-gray-800 border-2 border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </header>
                    <main>
                        <div class="channel-grid">
                            ${channelCardsHtml}
                        </div>
                    </main>
                    <footer class="text-center mt-12">
                        <a href="https://t.me/+OACGYQBHrIJmM2Y1" target="_blank" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition-colors">
                            Join us on Telegram
                        </a>
                        <p class="text-gray-500 mt-4 text-sm">&copy; 2024 Live TV Hub. All rights reserved.</p>
                    </footer>
                </div>
            `;
            
            // Add event listeners after rendering
            document.querySelectorAll('.channel-card').forEach(card => {
                card.addEventListener('click', () => {
                    const channelId = card.getAttribute('data-channel-id');
                    const newWindow = window.open(`?play=${channelId}`, '_blank');
                    if (!newWindow) {
                        alert('Please allow popups for this website to play channels.');
                    }
                });
            });

            document.getElementById('search-box').addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                const filtered = channels.filter(channel => 
                    channel.name.toLowerCase().includes(searchTerm) || 
                    channel.id.toLowerCase().includes(searchTerm)
                );
                // Re-render the grid part only
                const grid = document.querySelector('.channel-grid');
                let newGridHtml = '';
                filtered.forEach(channel => {
                    const logoText = encodeURIComponent(channel.name);
                    const logoUrl = `https://placehold.co/400x240/1a202c/718096?text=${logoText}&font=inter`;
                    newGridHtml += `
                    <div class="channel-card cursor-pointer bg-gray-800 rounded-lg overflow-hidden flex flex-col items-center p-3 border-2 border-gray-700 hover:border-blue-500" data-channel-id="${channel.id}">
                        <img src="${logoUrl}" alt="${channel.name} Logo" class="w-full h-auto object-cover rounded-md mb-2">
                        <p class="text-sm font-semibold text-center text-gray-300">${channel.name}</p>
                    </div>
                `;
                });
                grid.innerHTML = newGridHtml;
                 document.querySelectorAll('.channel-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const channelId = card.getAttribute('data-channel-id');
                        window.open(`?play=${channelId}`, '_blank');
                    });
                });
            });
        }

        function renderPlayer(channelId) {
            const channel = channels.find(c => c.id === channelId);
            if (!channel) {
                document.body.innerHTML = `<div class="w-screen h-screen flex items-center justify-center bg-gray-900 text-white text-2xl">Channel not found!</div>`;
                return;
            }

            let playerHtml = '';
            if (channel.mpd && channel.key) {
                playerHtml = getMpdPlayerHtml(channel);
            } else if (channel.m3u8) {
                playerHtml = getM3u8PlayerHtml(channel);
            } else {
                document.body.innerHTML = `<div class="w-screen h-screen flex items-center justify-center bg-gray-900 text-white text-2xl">Invalid channel data!</div>`;
                return;
            }
            
            // Directly write to the document to replace everything
            document.open();
            document.write(playerHtml);
            document.close();
        }

        // --- App Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const channelIdToPlay = urlParams.get('play');

            if (channelIdToPlay) {
                renderPlayer(channelIdToPlay);
            } else {
                renderChannelGrid();
            }
        });

    </script>
</body>
</html>
